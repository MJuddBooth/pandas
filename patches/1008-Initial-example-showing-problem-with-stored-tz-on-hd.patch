From b377d666d89dc303d511505e68df09b2b0ef1e65 Mon Sep 17 00:00:00 2001
From: Michael Booth <m.judd.booth@gmail.com>
Date: Sat, 17 Oct 2015 17:22:35 -0400
Subject: [PATCH 1008/1009] Initial - example showing problem with stored tz on
 hdf5

---
 pandas/tests/bug_storedtz.py | 40 ++++++++++++++++++++++++++++++++++++++++
 1 file changed, 40 insertions(+)
 create mode 100644 pandas/tests/bug_storedtz.py

diff --git a/pandas/tests/bug_storedtz.py b/pandas/tests/bug_storedtz.py
new file mode 100644
index 0000000..3e95f08
--- /dev/null
+++ b/pandas/tests/bug_storedtz.py
@@ -0,0 +1,40 @@
+'''
+Created on Jan 12, 2015
+
+@author: booth
+'''
+
+import os
+import glob 
+
+import datetime
+from pandas import DataFrame, Series, Timestamp
+from pandas.io.pytables import HDFStore
+import numpy as np
+from datetime import datetime
+
+import pandas as pd
+
+ind  = pd.date_range(Timestamp("2015-01-01"), periods = 3, tz = "US/Eastern")
+
+df   = DataFrame({"C1" : [ 1, 2, 3]}, index = ind)
+
+#df.to_hdf("/tmp/test_tz.h5", key = "df", format = "table", complib = "blosc")
+#df.to_hdf("/tmp/test_tz.h5", key = "df")
+
+df2 = pd.read_hdf("/tmp/test_tz.h5", key = "df")
+
+
+def dictDiff(d1, d2):
+    d1_2 = set(d1.keys()).difference(d2.keys())
+    d2_1 = set(d2.keys()).difference(d1.keys())
+    d12  = set(d2.keys()).intersection(d1.keys())
+    dv   = [(k, (d1[k], d2[k])) for k in d12 if d1[k] != d2[k]]
+    return [(k, d1[k]) for k in d1_2], [(k, d2[k]) for k in d2_1], dv 
+    
+#assert df.index.tz == df2.index.tz, "TZs don't match"
+if df.index.tz != df2.index.tz:
+    print("tzs don't match!")
+    print("new, stored")
+    print(dictDiff(vars(df.index.tz), vars(df2.index.tz)))
+
-- 
2.6.0


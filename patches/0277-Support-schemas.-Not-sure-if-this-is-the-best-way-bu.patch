From 588331dfe608a5eaf27c1bfe775207f6dbfaf94c Mon Sep 17 00:00:00 2001
From: Michael Booth <m.judd.booth@gmail.com>
Date: Sat, 23 Aug 2014 22:39:35 -0400
Subject: [PATCH 0277/1009] Support schemas.  Not sure if this is the "best"
 way but it works.

---
 pandas/io/sql.py | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

diff --git a/pandas/io/sql.py b/pandas/io/sql.py
index bb6f9ce..3abcbf4 100644
--- a/pandas/io/sql.py
+++ b/pandas/io/sql.py
@@ -811,14 +811,26 @@ class PandasSQLAlchemy(PandasSQL):
     def tables(self):
         return self.meta.tables
 
+# What's the right way to handle schemas?  
     def has_table(self, name):
-        if self.meta.tables.get(name) is not None:
+        schema = self.meta.schema
+        if schema:
+            fqname = "{}.{}".format(schema, name)
+        else:
+            fqname = name
+        if self.meta.tables.get(fqname) is not None:
             return True
         else:
             return False
 
     def get_table(self, table_name):
-        return self.meta.tables.get(table_name)
+        schema = self.meta.schema
+        if schema:
+            fqname = "{}.{}".format(schema, table_name)
+        else:
+            fqname = table_name
+        
+        return self.meta.tables.get(fqname)
 
     def drop_table(self, table_name):
         if self.engine.has_table(table_name):
-- 
2.6.0

